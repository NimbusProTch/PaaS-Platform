apiVersion: platform.infraforge.io/v1
kind: ApplicationClaim
metadata:
  name: test-app-claim
  namespace: default
spec:
  environment: development
  namespace: test-app
  applications:
    - name: backend-service
      repository: github.com/infraforge/backend-service
      version: v1.0.0
      replicas: 2
      resources:
        requests:
          cpu: "100m"
          memory: "128Mi"
        limits:
          cpu: "200m"
          memory: "256Mi"
      ports:
        - name: http
          port: 8080
          protocol: TCP
      healthCheck:
        path: /health
        port: 8080
        initialDelaySeconds: 30
        periodSeconds: 10
      env:
        - name: DATABASE_URL
          value: "postgresql://postgres:5432/testdb"
        - name: REDIS_URL
          value: "redis://redis:6379"
  components:
    - name: postgres-db
      type: postgresql
      version: "14"
      size: small
      config:
        database_name: testdb
        max_connections: "100"
    - name: redis-cache
      type: redis
      version: "7"
      size: small
      config:
        maxmemory: "256mb"
  owner:
    team: Platform Team
    email: platform@infraforge.io
    slack: "#platform-team"