# Nginx Helm Values Template
# Generated by InfraForge

replicaCount: {{ .Values.replicaCount }}

image:
  registry: docker.io
  repository: bitnami/nginx
  tag: 1.25.3-debian-11-r1

service:
  type: ClusterIP
  ports:
    http: 80
    https: 443

ingress:
  enabled: {{ .Values.ingress.enabled }}
  pathType: Prefix
  hostname: nginx-{{ .Tenant }}-{{ .Environment }}.local
  ingressClassName: nginx
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
  tls: false

resources:
  limits:
    cpu: {{ .Values.resources.limits.cpu }}
    memory: {{ .Values.resources.limits.memory }}
  requests:
    cpu: {{ .Values.resources.requests.cpu }}
    memory: {{ .Values.resources.requests.memory }}

autoscaling:
  enabled: {{ .Values.autoscaling.enabled }}
  minReplicas: {{ .Values.autoscaling.minReplicas }}
  maxReplicas: {{ .Values.autoscaling.maxReplicas }}
  targetCPU: 80
  targetMemory: 80

# Health checks
livenessProbe:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3

readinessProbe:
  enabled: true
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  successThreshold: 1
  failureThreshold: 3

# Custom nginx configuration
serverBlock: |-
  server {
    listen 8080;
    server_name _;
    
    location / {
      return 200 "Nginx running for {{ .Tenant }} in {{ .Environment }} environment\n";
      add_header Content-Type text/plain;
    }
    
    location /health {
      return 200 "OK";
      add_header Content-Type text/plain;
    }
  }